\chapter{Discussion}

In this chapter, in depth discussion about specific parts of the thesis will follow.
Readers that are only interested in the overarching conclusions about the use of symmetries for modelling in biology are referred to the last section, \cref{sec:future}.

\section{The parameter independence method}

In \cref{ch:param-ind} the method of parameter independence was introduced as an alternative to ansatz testing for solving the linearized symmetry condition for first order ODE:s.
The method tackles two related problems of ansatz testing: the lack of a stopping point and the lack of value from \enquote{failed} calculations.
Similarly to ansatz testing, the method solves the fundamental problem of the linearized symmetry condition having an infinite amount of and often hard to find solutions by looking for specific subsets of solutions.
But instead of limiting the forms of solutions by their dependency on state, as is the case with ansatz testing, the forms of the solutions are instead limited by their dependency of parameters.
While it is hard to interpret the family of symmetries corresponding to generators independent in a state, which is an ansatz that could be made, the interpretation of symmetries corresponding to generators independent in a parameter is clear, given that the parameter has biological meaning; such symmetries are symmetries of the entire family of systems where the parameter is not fixed.

As seen in \cref{ch:uses}, the parameter independence method can lead to symmetries not found using ansätze that have value in later calculations.
To properly analyze the value of the parameter independence method in its current form, a larger class of models would have to be studied, and a more complete heuristic approach to ansatz testing would have to be used.
More information about the use cases for the symmetries would also affect such an analysis, as symmetries of first order ODE:s that on the surface look different might functionally be the same for certain calculations performed using found symmetries.
However, even if the method were not to produce significant new symmetries compared to heuristic ansatz testing in most cases, the theory around the method could have theoretical value, as it is a specialized application of the more general theory of the group classification introduced by \citeauthor{ovsiannikov1982group} \cite{ovsiannikov1982group}.
Utilization of the more general theory in this context could have significant value, as it could be used to study more general model families, where parameters can be functions of states.
Additionally, a common differentiation in modeling of populations is that between population parameters and parameters of a single individual.
Extensions of the theory could potentially be used to improve the study of variability between individuals.

Since the method has a clear stopping condition (calculating all symmetries independent of at least on parameter), the method also produces meaningful negative results.
For the Lotka--Volterra predator prey model, the only Lie point symmetry group independent of any parameters (modulo trivial symmetries) is time invariance, generated by \(\partial_t\).
It was also the only symmetry group found using the ansatz, but the difference in the conclusions that can be drawn are stark.
Using an ansatz, the only conclusion from the calculations is that apart from the manifest symmetry generated by \(\partial_t\), no fundamentally different group of Lie symmetries can be generated by generators on the form \cref{eq:lotka-volterra-ansatz} of the ansatz.
Using the parameter independence method on the other hand, the conclusion is that using the parametrization in \cref{eq:lotka-volterra} of the Lotka-Volterra model, the family of systems it represents can not be subdivided by any parameter into subfamilies that have additional symmetric properties.
Thus, the lack of symmetries gives a deeper understanding of the symmetric properties of the model.

Still, the method has some limitations.
While the minimum number of parameter independence determining equations is \(2s+1\) where \(s\) is the number of states, compared to the \(s\) equations of the linearized symmetry condition, the resulting system is still a system of partial differential equations.
Additionally, even for first order ODE:s, the number of partial derivatives in the parameter independence determining equations scales by \((s + 1)^2\) (\(s + 1\) unknown functions and \(s + 1\) states and time to derive in).
While linear algebra can be used to classify systems of algebraic equations as over- and underdetermined, the differential properties of differential equations mean that such distinctions can not be made for the determining equations.
Without delving deeper into the corresponding theory for differential equations, it is still clear that the potential for the partial derivatives to scale in number faster than the equations poses a problem.
Whether these theoretical bounds pose a practical problem for typical models is essential to understand before the parameter independence method can be automated.

\section{Solving determining equations and computer assistance}

Using both ansätze and the parameter independence method in \cref{ch:ansatze} and \cref{ch:param-ind} respectively, the calculations required quickly get unviable to solve purely by hand when the models and ansätze grow.
In this thesis this problem was solved by using computer algebra to keep track of calculations.
The calculations were however not fully automated, due to several factors.
First and foremost, such automation is outside the scope of this thesis and would take some time to implement properly.
But additionally, such an implementation would not be trivial.
As mentioned in the previous section, the determining equations resulting from the parameter independence method are PDE:s, and as such can not generally be solved analytically.
Similarly, more general ansätze such as the one used for the Hill equation in \cref{sec:hill-ansatze} also result in ansatz determining equations on the form of differential equations.
An automated system should therefore be able to handle at least the common cases of differential forms if the equations are solvable.
Both to determine solvability and to solve the equations, related theory such as the theory of involution need be used \cite{seiler2009involution}.
Since the determining equations have a highly regular form compared to general differential equations, it is not at all impossible to imagine at least specific types of determining equations being solvable using such methods.

A deeper theoretical understanding of the computational aspect of symmetries is also important for scaling the calculations.
In this thesis SymPy \cite{meurer2017sympy} was used to perform the computer algebra; being implemented in Python, the speed of the calculations is not optimal.
Additionally, many parts of the calculations are performed using general purpose functions, which means that a more specialized implementation could probably lead to speed-ups.
Even weighing in these factors, it is clear that the naïve algorithms used in this thesis scale poorly with growing system size.
In \cref{sec:lac-operon-ansatze} the ansatz used had to be limited to a linear one, purely due to computational limitations.
As there are many models of greater size than the Yildirim--Mackey lactose operon model, even with performance improvements from using more specialized programming languages and functions, the fundamental algorithms need to be changed for the calculations to scale properly.

\section{The structure of first order ODE symmetry groups}

% Calculations in thesis
% Comparison of Gompertz, less technical discussion
% In general only matrix related to properties
% Matrix connection to invariants
% Use method to find actual symmetries?

\section{The future of symmetries for modelling in biology} \label{sec:future}

As outlined in \cref{sec:symmetries-as-tool}, the possibilities for using symmetries in biological modeling is promising.
If using symmetries turns out to be viable in even one of the cases presented, or another way relevant to researchers in biology, problems that so far have been impossible or too time consuming to solve might suddenly be viable to approach.
The strength of using symmetries is that they relate to qualitative information about the systems studied, while most of the mathematical tools available to researchers at the moment relate to quantitative information.
Symmetries could therefore bridge the gap between established qualitative facts on the biological side of research and the mathematical models and simulations of those biological systems.

Common to all the possible uses for symmetries is the need for the researcher to be able to find symmetries of a system.
In this thesis only first order ODE:s were considered, and even in this case the calculations involved in finding symmetries grew to the scale were automation is needed, as seen in \cref{ch:ansatze,ch:param-ind}.
For most biological systems, ODE-models are simplifications of more sophisticated models that involve spatiality (and with that often higher order dynamics), randomness and time-delays.
While the mathematics involved in finding symmetries for these more sophisticated models is far more complex than the theory covered in this thesis, the fact that the concept of symmetries can be generalized to most settings is a cause for optimism.
The methods developed for determination of symmetries of ODE:s will thus have a good chance of being generalizable or at least have parallels when finding symmetries of more advanced systems.

As an example, the method of parameter independence developed in this thesis in \cref{ch:param-ind} solves problems in finding symmetries of first order ODE:s arising from the fact that the Lie algebras of the symmetries of first order ODE:s being infinite dimensional.
But even for higher order differential equations, especially PDE:s, the problem of finding a general form for symmetry generators might not be viable to solve.
The method of parameter independence could then be used to find general forms of at least all generators independent of some parameter in the same way as for first order ODE:s, as the method is compatible with the generalizations of the symmetry theory to higher order PDE:s.
Similar results should be expected for many methods developed for some specialized subset of differential equations, which means that the study symmetries of simplified biological models can act as a stepping stone to more robust methods.
This indicates that there are good conditions for further research on symmetries in biological modelling.
