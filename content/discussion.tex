\chapter{Discussion}

In this chapter, in depth discussion about specific parts of the thesis will follow.
Readers that are only interested in the overarching conclusions about the use of symmetries for modeling in biology are referred to the last section, \cref{sec:future}.

\section{The parameter independence method}

In \cref{ch:param-ind} the method of parameter independence was introduced as an alternative to ansatz testing for solving the linearized symmetry condition for first order ODE:s.
The method tackles two related problems of ansatz testing: the lack of a stopping point and the lack of value from \enquote{failed} calculations.
Similarly to ansatz testing, the method solves the fundamental problem of the linearized symmetry condition having an infinite amount of and often hard to find solutions by looking for specific subsets of solutions.
But instead of limiting the forms of solutions by their dependency on time and states, as is the case with ansatz testing, the forms of the solutions are limited by their dependency of parameters.
Interpretations of a family of symmetries corresponding to generators independent of a particular state, which is an ansatz that could be made, lead to very general statements about which states have what types of interactions.
Conversely, interpretations of symmetries corresponding to generators independent of a parameter are very specific, given that the parameter has biological meaning; such symmetries are symmetries of the entire family of systems where the parameter is not fixed.

As seen in \cref{ch:uses}, the parameter independence method can lead to symmetries not found using ansätze that have value in later calculations.
To properly analyze the value of the parameter independence method in its current form, a larger class of models would have to be studied, and a more complete heuristic approach to ansatz testing would have to be used.
More information about the use cases for the symmetries would also affect such an analysis: should two symmetries that relate to the same underlying invariant, as seen for the Lotka--Volterra model in \cref{ch:uses}, be seen as the same symmetry or separate for the purposes of such a study?
However, even if the method was not to produce significant new symmetries compared to heuristic ansatz testing in most cases, the theory around the method could have theoretical value, as it is a specialized application of the more general theory of the group classification introduced by \citeauthor{ovsiannikov1982group} \cite{ovsiannikov1982group}.
Utilization of the more general theory in the context of the parameter independence method could have significant value, as it could be used to study more general model families, where parameters can be functions of states.
Additionally, a common differentiation in modeling of populations is that between population parameters and parameters of a single individual.
Extensions of the theory could potentially be used to improve the study of variability between individuals.

Since the method has a clear stopping condition (calculating all symmetries independent of at least one parameter), the method also produces meaningful negative results.
For the Lotka--Volterra predator prey model, the only Lie point symmetry group independent of any parameters (modulo trivial symmetries) is time invariance, generated by \(\partial_t\).
It was also the only symmetry group found using the ansatz, but the difference in the conclusions that can be drawn are stark.
Using an ansatz, the only conclusion from the calculations is that apart from the manifest symmetry generated by \(\partial_t\), no fundamentally different group of Lie symmetries can be obtained from generators on the form \cref{eq:lotka-volterra-ansatz} of the ansatz.
Using the parameter independence method on the other hand, the conclusion is that using the parametrization in \cref{eq:lotka-volterra} of the Lotka-Volterra model, the family of systems it represents can not be subdivided by any parameter into subfamilies that have additional symmetric properties.
Thus, the lack of symmetries gives a deeper understanding of the symmetric properties of the model.

Still, the method has some limitations.
While the minimum number of parameter independence determining equations is \(2s+1\) where \(s\) is the number of states, compared to the \(s\) equations of the linearized symmetry condition, the resulting system is still a system of partial differential equations.
Additionally, even for first order ODE:s, the number of partial derivatives in the parameter independence determining equations scales by \((s + 1)^2\) (\(s + 1\) unknown functions and \(s + 1\) states and time to derive in).
While linear algebra can be used to classify systems of algebraic equations as over- and underdetermined, the differential properties of differential equations mean that such distinctions can not be made for the determining equations.
Without delving deeper into the corresponding theory for differential equations, it is still clear that the potential for the partial derivatives to scale in number faster than the equations poses a problem.
Whether these theoretical bounds pose a practical problem for typical models is essential to understand before the parameter independence method can be automated.

\section{Solving determining equations and computer assistance}

Using both ansätze and the parameter independence method in \cref{ch:ansatze} and \cref{ch:param-ind} respectively, the calculations required quickly get unviable to solve purely by hand when the models and ansätze grow.
In this thesis this problem was solved by using computer algebra to keep track of calculations.
The calculations were however not fully automated, due to several factors.
First and foremost, such automation is outside the scope of this thesis and would take some time to implement properly.
But additionally, such an implementation would not be trivial.
As mentioned in the previous section, the determining equations resulting from the parameter independence method are PDE:s, and as such can not generally be solved analytically.
Similarly, more general ansätze such as the one used for the Hill equation in \cref{sec:hill-ansatze} also result in ansatz determining equations on the form of differential equations.
An automated system should therefore be able to handle at least the common cases of differential forms if the equations are solvable.
Both to determine solvability and to solve the equations, related theory such as the theory of involution need be used \cite{seiler2009involution}.
Since the determining equations have a highly regular form compared to general differential equations, it is not at all impossible to imagine at least specific types of determining equations being solvable using such methods.

A deeper theoretical understanding of the computational aspect of symmetries is also important for scaling the calculations.
In this thesis SymPy \cite{meurer2017sympy} was used to perform the computer algebra; being implemented in Python, the speed of the calculations is not optimal.
Additionally, many parts of the calculations are performed using general purpose functions, which means that a more specialized implementation could probably lead to speed-ups.
Even weighing in these factors, it is clear that the naïve algorithms used in this thesis scale poorly with growing system size.
In \cref{sec:lac-operon-ansatze} the ansatz used had to be limited to a linear one, purely due to computational limitations.
As there are many models of greater size than the Yildirim--Mackey lactose operon model, even with performance improvements from using more specialized programming languages and functions, the fundamental algorithms need to be changed for the calculations to scale properly.

\section{The structure of first order ODE symmetry groups}

The calculations of the structure of the symmetry generators for some of the models in \cref{ch:uses} generate some interesting results that are worth discussing further.

For the Gompertz models, the most general structure of the symmetry generators were calculated.
The two scalar models, the classical and autonomous Gompertz models, each have one non-trivial symmetric property in accordance with the theory established in \cref{sec:lie-point-properties}.
Each such symmetric property relates to an infinite amount of symmetry generators for each of the models, obtained by multiplying a base generator with an arbitrary function of an invariant of the system.
The two scalar models' symmetric properties correspond directly to the two symmetric properties of the system Gompertz model.
Thus, the two scalar formulations of the model are specializations of the system formulation, differing in which symmetric property is preserved.
This is in clear parallel to viewing the two scalar models as the system Gompertz model, but with one of the two boundary conditions of the problem fixed.
The boundary conditions will, for the system Gompertz model, determine the values of \(A\) and \(T_i\) in the solution curve
\begin{equation*}
  W(t) = A e^{-e^{-k_G(t-T_i)}}
\end{equation*}
or \(A\) and \(W_0\) in
\begin{equation*}
  W(t) = A \left(\frac{W_0}{A}\right)^{-e^{-k_G t}}
\end{equation*}
depending on the parametrization.
Fixing the time of inflection \(T_i\) or the size relative to the upper asymptote \(\frac{W_0}{A}\) at time \(t = 0\) clearly eliminates time invariance, and thus the classical Gompertz model loses the time invariance generated by \(\partial_t\) of the system Gompertz model, independent of the parametrization.
Similarly, the generator \(W \partial_W\) should be associated to fixing the upper asymptote \(A\).
By viewing \(W \partial_W\) as the property that growth is proportional to size this association becomes clear; fixing the upper asymptote \(A\), the scale of the growth is fixed.
%That the trivial symmetries of the scalar are non-trivial symmetries of each other is a natural consequence of this.
%If the time of inflection is fixed, all solutions will flow along

Whether the classical, autonomous or system Gompertz model is most suitable for modeling a particular system comes down to whether which, or both, of these properties are desired.
As a model for limb growth for an animal, time invariance is not a necessary property; the limb could not as well start growing in a month, and the progression towards maturity of an animal is often a known factor.
For such situations the classical Gompertz model describes the system more correctly.
The remaining symmetry of growth relating to size then corresponds to the same growth pattern being observed for specimen of different size.
Conversely, as a model for tumor growth, the limiting factors of the environment should be fairly constant in an individual, and hence growth proportionality to size is not as relevant in the model.
For such a system the autonomous Gompertz model describes the system more correctly.
In practice, such distinctions might not be very relevant for fitting and testing the Gompertz model against data; as the system constants are as unknown as the individual constants and all need to be estimated to fit the model to data.
But as previously mentioned, the Gompertz model is not a very correct model for most scenarios.
While most of the types of knowledge and intuition gained from working with the Gompertz model must therefore be regained for more advanced alternative models, the symmetries of the Gompertz model can be used with similar interpretations for other models, as long as the state has the same physical quantity.
This is due to the ability to formulate characteristic symmetries of both the scalar models parameter independently.
The motivation for using the parameter independence method is thus further strengthened.

All of the biological interpretations above relate to the matrix
\begin{equation*}
  \left(\partial_{(W, G)} \vect{J}\right)^{-1},
\end{equation*}
which in turn is only dependent on the invariants of the differential equations.
There is therefore good reason to question whether symmetries are a useful way of investigating these types of biological properties of ODE:s.
While the calculations in this thesis do not prove anything conclusively, approaches such as the one in \cref{ch:uses} to calculate invariants from reduced characteristics seems like a useful alternative when normal invariant calculations fail.
Additionally, as seen for the structure of the Lotka--Volterra predator prey model, finding a function \(J\) consisting of functionally independent invariants is not always viable.
In the case of the Lotka--Volterra model, the symmetry calculations lead to a partial construction of the general structure of the symmetries of the model, something that is not possible when using only the invariant theory, as the function \(\partial_{(W, G)} \vect{J}\) is not fully known and therefore not invertible.
Lastly, the symmetry generators are more intuitive for interpreting the symmetric properties than the basis of the reduced characteristic.
Viewing the problem both from the perspective of symmetries and invariants of the differential equation is therefore preferable.
% Calculations in thesis
% Comparison of Gompertz, less technical discussion
% In general only matrix related to properties
% Matrix connection to invariants
% Use method to find actual symmetries?

\section{The future of symmetries for modeling in biology} \label{sec:future}

As outlined in \cref{sec:symmetries-as-tool}, the possibilities for using symmetries in biological modeling is promising.
If using symmetries turns out to be viable in even one of the cases presented, or another way relevant to researchers in biology, problems that so far have been impossible or too time consuming to solve might suddenly be approachable.
The strength of using symmetries is that they relate to qualitative information about the systems studied, while most of the mathematical tools available in mathematical biology at the moment relate to quantitative information.
Symmetries could therefore bridge the gap between established qualitative facts on the biological side of research and the mathematical models and simulations of those biological systems.

Common to all the uses for symmetries mentioned in this thesis is the need for the researcher to be able to find symmetries of a system.
In this thesis only first order ODE:s were considered, and even in this case the calculations involved in finding symmetries grew to the scale were automation is needed, as seen in \cref{ch:ansatze,ch:param-ind}.
For most biological systems, ODE-models are simplifications of more sophisticated models that involve spatiality (and with that often higher order dynamics), randomness and time-delays.
While the mathematics involved in finding symmetries for these more sophisticated models is far more complex than the theory covered in this thesis, the fact that the concept of symmetries can be generalized to most settings is a cause for optimism.
The methods developed for determination of symmetries of ODE:s will thus have a good chance of being generalizable or at least have parallels when finding symmetries of more advanced systems.

As an example, the method of parameter independence developed in this thesis in \cref{ch:param-ind} solves problems in finding symmetries of first order ODE:s arising from the fact that the Lie algebras of the symmetries of first order ODE:s are infinite dimensional.
But even for higher order differential equations, especially PDE:s, the problem of finding a general form for symmetry generators might not be viable to solve.
The method of parameter independence could then be used to find general forms of at least all generators independent of some parameter in the same way as for first order ODE:s, as the method is compatible with the generalizations of the symmetry theory to higher order PDE:s.
Similar results should be expected for many methods developed for some specialized subset of differential equations, which means that the study of symmetries of simplified biological models can act as a stepping stone to more robust methods.
This indicates that there are good conditions for further research on symmetries in biological modeling along the directions outlined in this thesis.
