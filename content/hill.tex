\chapter{The Hill model}

In this chapter, Lie point symmetries for the Hill model will be calculated.
Since this work has already been done in \cite{ohlsson2020symmetry}, this will serve as a reproduction of their results.

%=============================================================================
\section{The Hill equation}

The Hill equation is an ODE that empirically describes cooperative binding to a multi-site protein.
It takes the form
\begin{equation} \label{eq:original-hill}
  \dv{Y}{t} = - v_\text{max} \frac{Y^n}{K_m + Y^n} = \Omega_n(t, Y), \quad
  n > 0.
\end{equation}
By nondimensionalizing both the substrate concentration with
\begin{equation}
  y = \frac{Y}{{K_m}^{1/n}}
\end{equation}
and the time with
\begin{equation}
  \tau = v_\text{max} \frac{t}{{K_m}^{1/n}},
\end{equation}
\cref{eq:original-hill} simplifies to
\begin{equation} \label{eq:hill}
  \dv{y}{\tau} = - \frac{y^n}{1 + y^n} = \omega_n(\tau, y), \quad
  n > 0,
\end{equation}
where \(y'\) denotes the derivative \(\dv{y}{\tau}\), and will do so for the remainder of this chapter.

%=============================================================================
\section{A useful infinitesimal generator}

The Hill equation clearly has at least the Lie symmetry generator \(X=\partial_\tau\).
This can be seen by observing that \cref{eq:hill} has no \(\tau\) in either side's expression (remember that the equation is viewed in terms of its lift, residing in the jet space \(J^1\)).
However, one purpose of finding symmetries of differential equations is to distinguish between models.
Since the symmetry \(X=\partial_\tau\) holds for all \(n\), it can not be used to compare different degrees of Hill models.
Thus, finding an additional Lie symmetry group of the Hill equation is therefore of interest.

Any Lie point symmetry group must fulfill the linearized symmetry condition \ref{thm:linearized-first-order-symmetry}.
To solve \cref{eq:linearized-first-order-symmetry}, an Ansatz must be made.
The tangent fields of many Lie symmetries of ODE:s are linear in \(y\).
The Ansatz
\begin{equation}
  \pqty{\xi(\tau,y),\eta(\tau,y)} = \pqty{A(\tau) + B(\tau)y,C(\tau) + D(\tau)y}
\end{equation}
is therefore used.
Inserting the Ansatz into \cref{eq:linearized-first-order-symmetry}, and using the fact that \(y' = y^n / (1 + y^n)\), gives that
\begin{equation}
  (C' + D'y) + (A' + B'y - D) \frac{y^n}{1 + y^n} - B \frac{y^{2n}}{(1 + y^n)^2} =
  -n(C + Dy) \frac{y^{n-1}}{(1 + y^n)^2}.
\end{equation}
Multiplication with \((1 + y^n)^2\) in turn gives that
\begin{equation} \label{eq:hill-linear-symmetry}
  (C' + D'y)(1 + y^n)^2 + (A' + B'y - D)y^n(1 + y^n) - By^{2n} =
  -n(C + Dy) y^{n-1}.
\end{equation}
The equation can then be separated by powers of \(y\) into a system of equations.
However, since \(n\) is specified to be positive, care must be taken to ensure that the separation holds for all \(n>0\).

%-----------------------------------------------------------------------------
\subsection{Case of \texorpdfstring{\(n\neq1,2\)}{n not 1 or 2}}

When \(n>0\) and \(n\neq1,2\), all of the possible powers of \(y\) will be different.
\Cref{eq:hill-linear-symmetry} can the be separated into the system
\begin{subequations}
  \begin{flalign}
    y^0:      && C'(\tau) &= 0                               &&\FlLabel{eq:det-any-0}\\
    y^1:      && D'(\tau) &= 0                               &&\FlLabel{eq:det-any-1} \\
    y^{n-1}:  && 0 &= -nC(\tau)                              &&\FlLabel{eq:det-any-nm1} \\
    y^n:      && 2C'(\tau) + A'(\tau) - D(\tau) &= -nD(\tau) &&\FlLabel{eq:det-any-n} \\
    y^{n+1}:  && 2D'(\tau) + B'(\tau) &= 0                   &&\FlLabel{eq:det-any-np1} \\
    y^{2n}:   && C'(\tau) A'(\tau) - D(\tau) - B(\tau) &= 0  &&\FlLabel{eq:det-any-2n} \\
    y^{2n+1}: && D'(\tau) + B'(\tau) &= 0.                   &&\FlLabel{eq:det-any-2np1}
  \end{flalign}
\end{subequations}
From \cref{eq:det-any-nm1}
\begin{equation}
  C(\tau) = 0,
\end{equation}
which renders \cref{eq:det-any-0} irrelevant.
\Cref{eq:det-any-1} gives
\begin{equation}
  D(\tau) = c_1
\end{equation}
for a constant \(c_1\) (constants will further be denoted \(c_i\)).
\Cref{eq:det-any-n} can with the determined values for \(C\) and \(D\) be reduced to
\begin{equation}
  A'(\tau) = (1-n) c_1,
\end{equation}
which means that
\begin{equation}
  A(\tau) = c_2 + (1-n) c_1 x.
\end{equation}
Using \cref{eq:det-any-np1} and the determined value of \(D\),
\begin{equation}
  B(\tau) = c_3,
\end{equation}
which in turn renders \cref{eq:det-any-2np1} irrelevant.
Lastly, \cref{eq:det-any-2n} can be reduced to
\begin{equation}
  (1-n) c_1 - c_1 - c_3 = 0,
\end{equation}
which means that
\begin{equation}
  c_3 = -n c_1.
\end{equation}
All tangent fields given the Ansatz must therefore be on the form
\begin{equation} \label{eq:hill-tangent-field-any}
  \pqty{\xi_n(\tau,y),\eta_n(\tau,y)} = 
  \pqty{\tilde{c}_1 + \tilde{c}_2 \left( (1-n) \tau - n y \right), \tilde{c}_2 y}.
\end{equation}

%-----------------------------------------------------------------------------
\subsection{Case of \texorpdfstring{\(n=1\)}{n is 1}}

When \(n=1\) several pairs of powers of \(y\) become equal.
\(y^0 = y^{n-1}\), \(y^1 = y^n\) and \(y^{n+1} = y^{2n}\).
\Cref{eq:hill-linear-symmetry} is therefore separated into the system
\begin{subequations}
  \begin{flalign}
    y^0:  && C'(\tau) &= -C(\tau) &&\FlLabel{eq:det-1-0}\\
    y^1:  && D'(\tau) + 2C'(\tau) + A'(\tau) - D(\tau) &= -D(\tau) &&\FlLabel{eq:det-1-1}\\
    y^2:  && 2D'(\tau) + B'(\tau) + C'(\tau) + A'(\tau) - D(\tau) - B(\tau) &= 0 &&\FlLabel{eq:det-1-2}\\
    y^3:  && D'(\tau) + B'(\tau) &= 0. &&\FlLabel{eq:det-1-3}
  \end{flalign}
\end{subequations}
Using \cref{eq:det-1-3}, the relation
\begin{equation} \label{eq:det-1-DB-rel}
  D(\tau) = - B(\tau) + c_1
\end{equation}
can be established.
\Cref{eq:det-1-0} leads to
\begin{equation} \label{eq:det-1-first-C}
  C(\tau) = c_2 e^{-\tau}.
\end{equation}
Subtracting \cref{eq:det-1-1} from \cref{eq:det-1-2} leads to the equation
\begin{equation}
  D'(\tau) + B'(\tau) - C'(\tau) - B(\tau) = D(\tau),
\end{equation}
which by using \cref{eq:det-1-DB-rel,eq:det-1-first-C} can be simplified to
\begin{equation}
  c_2 e^{-\tau} = c_1.
\end{equation}
This only holds if \(c_1 = c_2 = 0\) so
\begin{gather}
  C(\tau) = 0 \\
  D(\tau) = - B(\tau).
\end{gather}
Finally, \cref{eq:det-1-1} simplifies to
\begin{equation}
  D'(\tau) + A'(\tau) = 0,
\end{equation}
which integrates to
\begin{equation}
  D(\tau) = - A(\tau) + c_3.
\end{equation}
Thus, all tangent fields given the Ansatz must be on the form
\begin{equation} \label{eq:hill-tangent-field-1}
  \pqty{\xi_1(\tau,y),\eta_1(\tau,y)} = 
  \pqty{A(\tau) + \left( A(\tau) + \tilde{c}_1 \right) y, - \left( A(\tau) + \tilde{c}_1 \right) y}.
\end{equation}

%-----------------------------------------------------------------------------
\subsection{Case of \texorpdfstring{\(n=2\)}{n is 2}}

When \(n=2\), \(y^1 = y^{n-1}\).
\Cref{eq:hill-linear-symmetry} then separates into the system
\begin{subequations}
  \begin{flalign}
      y^0:  && C'(\tau) &= 0                               &&\FlLabel{eq:det-2-0}\\
      y^1:  && D'(\tau) &= -2C(\tau)                       &&\FlLabel{eq:det-2-1}\\
      y^2:  && 2C'(\tau) + A'(\tau) - D(\tau) &= -2D(\tau) &&\FlLabel{eq:det-2-2}\\
      y^3:  && 2D'(\tau) + B'(\tau) &= 0                   &&\FlLabel{eq:det-2-3}\\
      y^4:  && C'(\tau) A'(\tau) - D(\tau) - B(\tau) &= 0  &&\FlLabel{eq:det-2-4}\\
      y^5:  && D'(\tau) + B'(\tau) &= 0.                   &&\FlLabel{eq:det-2-5}
  \end{flalign}
\end{subequations}
Subtracting \cref{eq:det-2-5} from \cref{eq:det-2-3} gives
\begin{equation}
  D'(\tau) = 0,
\end{equation}
which integrates to
\begin{equation}
  D(\tau) = c_1.
\end{equation}
Thus \cref{eq:det-2-1} gives
\begin{equation}
  C(\tau) = 0,
\end{equation}
which renders \cref{eq:det-2-0} irrelevant.
\Cref{eq:det-2-2} simplifies to
\begin{equation}
  A'(\tau) = - c_1,
\end{equation}
which integrates to
\begin{equation}
  A(\tau) = c_2 - c_1 \tau.
\end{equation}
\Cref{eq:det-2-4} simplifies to
\begin{equation}
  - c_1 - c_1 - B(\tau) = 0,
\end{equation}
which means that
\begin{equation}
  B(\tau) = -2 c_1
\end{equation}
and renders \cref{eq:det-2-5} irrelevant.
Thus, all tangent fields must given the Ansatz be on the form
\begin{equation} \label{eq:hill-tangent-field-2}
  \pqty{\xi_2(\tau,y),\eta_2(\tau,y)} = 
  \pqty{\tilde{c}_1 + \tilde{c}_2 \left( - \tau -2 y \right), \tilde{c}_2 y}.
\end{equation}

%-----------------------------------------------------------------------------
\subsection{General form}

To unify notation for any \(n>0\), \cref{eq:hill-tangent-field-any,eq:hill-tangent-field-1,eq:hill-tangent-field-2} can be summarized as
\begin{equation} \label{eq:hill-tangent-field}
  \pqty{\xi_n(\tau,y),\eta_n(\tau,y)} = 
  \pqty{\tilde{c}_1 + \tilde{c}_2 \left( (1-n) \tau - n y \right), \tilde{c}_2 y}.
\end{equation}
For \(n=1\) this form can be achieved by specifying that \(A(\tau)\) has a constant value and grouping the two resulting constants in the right way.
As this constriction on \(A(\tau)\) when \(n=1\) is only made to get a common expression, while for all other \(n>0\) the expression in \cref{eq:hill-tangent-field} constitutes all symmetries whose generators are linear in \(y\), certain underlying structures of the ODE are only present when \(n=1\). % FIXME: Bad formulation

The aim of this section was to find a useful symmetry group.
That is, a symmetry group that varies for different Hill coefficients \(n\).
The symmetry group in \cref{eq:hill-tangent-field} clearly varies in such a way.
Just from looking at the problem, it was also determined that there is a symmetry group generated by \(\pqty{\xi,\eta} = \pqty{1,0}\) that does not vary with \(n\).
As this generator is linear in \(y\), it is part of the generator in \cref{eq:hill-tangent-field}.
By separating the generator by the terms with \(\tilde{c}_1\) and \(\tilde{c}_2\), a basis for the vector space of symmetry groups on the form in \cref{eq:hill-tangent-field} can be established.
One natural basis is
\begin{gather}
  X_1 = \partial_\tau \\
  X_2 = - \left( (n-1) \tau + n y \right) \partial_\tau + y \partial_y,
\end{gather}
where \(X_1\) generates the non-varying symmetry group observed.
\(X_2\) on the other hand generates symmetry groups varying with \(n\), and can thus be used to distinguish between different Hill models.


%=============================================================================
\section{Invariant solutions under symmetry}

To better understand the underlying source of the Lie symmetry groups of the Hill equation, it is of interest to find curves invariant under the solution.
That is, solutions to the ODE that are mapped by the Lie symmetry group to the same curve.

% TODO: Add some references to theory and glue the paragraphs together
The reduced characteristic of the generator \(X_2 = - \left( (n-1) x + n y \right) \partial_\tau + y \partial_y\) is
\begin{align}
  \bar{Q} &= 
  \eta - \omega \xi = 
  y - \left( -\frac{y^n}{1+y^2} \right) \left( - \left( (n-1) \tau + n y \right) \right) =\\
  &= y \left(1 -\frac{y^{n-1} \left( (n-1) \tau + n y \right)}{1+y^2} \right).
\end{align}
Since solutions are invariant under a symmetry if the characteristic is 0 on the entire solution curve, invariant solutions must satisfy
\begin{equation}
  y \left(1 -\frac{y^{n-1} \left( (n-1) \tau + n y \right)}{1+y^n} \right) = 0.
\end{equation}
The solutions that meet this condition (aside from the trivial case \(y \equiv 0\)) must thus be on the form
\begin{equation}
  y^{n-1} \left( (n-1) \tau + n y \right) = 1+y^n,
\end{equation}
which is more clearly stated as
\begin{equation}
  (n-1) \left( \tau y^{n-1} + y^n \right) = 1.
\end{equation}
For all \(n>0\) except \(n=1\) such solutions exist, and take the form
\begin{equation} \label{eq:hill-invariants}
  \tau y^{n-1} + y^n = \frac{1}{n-1}.
\end{equation}
Determining the functions \(y(\tau)\) that are invariant for a given \(n\) can be bothersome, but some general insights can be made.
Since \cref{eq:hill-invariants} is a polynomial in \(y\) of degree \(n\), there will exist a finite amount of solutions (this holds for non-integer \(n\) too, as it can be bounded by Descartes' rule of signs). % FIXME: Strengthen this claim with a source https://math.stackexchange.com/a/1291211
Thus, the symmetries are not trivial since there exist an infinite amount of solutions to the ODE \ref{eq:hill}.
Additionally, since \(\tau\) is (dimensionless) time, any application of the model will have an initial condition on the form \(y(0) = y_0\).
By fixing \(\tau=0\) in \cref{eq:hill-invariants}, the initial condition of an invariant curve given any \(n>0, n\neq1\) is shown to be
\begin{equation}
  y(0) =\frac{1}{(n-1)^{1/n}}.
\end{equation}
