\chapter{Theory}

In this chapter, the mathematical theory used in the thesis will be presented.
The theory mostly concerns Lie group analysis, and has a strong focus on symmetry methods. % TODO: What is the difference?
It is mainly based on material from three sources.
The first source, \cite{hydon2000symmetry}, serves as a great introductory text on the subject of symmetry methods.
The second source, \cite{olver1995equivalence}, treats the subject stringently and serves as a good reference point for the reader who wishes to understand the theory in more depth.
The third source, \cite{ovsiannikov1982group}, deals with group classification.
Due to its earlier publication date, it treats some subjects in a less modern way than the first two sources, but makes up for it in concreteness.

The notation used in the thesis will be based on the notation in \cite{hydon2000symmetry}, employing partial notational concepts from \cite{olver1995equivalence} and \cite{ovsiannikov1982group} when further clarity is desired.

%=============================================================================
\section{Point symmetries}

In mathematics, a symmetry is a transformation that preserves some structure.
The word symmetry is used as the mathematical concept encompasses what is normally meant by symmetry.
A symmetric face is a face such that when mirrored it look the same.
Here, mirroring is the transformation and \enquote{looking the same} is the structure.
In mathematics, however, the structure must be well defined, or in more common language must be a statement that is easily confirmed as true or false.
The transformation can also be chosen more freely, beyond the transformations usually implied when commonly talking about symmetries.

The most common example of a mathematical symmetry is rotating and flipping a triangle.
The structure of the triangle can be stated as the location of all the vertices and the length of the edges between specific vertices.
Rotating an equilateral triangle 120 or 240 degrees around its center will change the location of each individual vertex, but the positions of the set of all vertices will remain the same.
Since the edges are unchanged relative to the points, these rotations thus constitute a symmetry of the triangle.
It is worth noting that the rotational transformations map points from the 2-dimensional plane to the two dimensional plane or, stated in mathematical terms, the rotations are mappings \(\Gamma: \reals^2 \to \reals^2\).

In group analysis transformations of this type are considered, but the structure of a triangle is instead replaced with the structure of a differential equation.
Initially, assume the differential equation is an ordinary differential equation (ODE) of the first order and can thus be written on the form
\begin{equation} \label{eq:first-order-ode}
  \dv{y}{x} = \omega(x,y).
\end{equation}
The structure of a first order ODE is thus defined by the function \(\omega\).
The function can be thought of to define a relationship between certain points in the \(xy\)-plane, subdividing them into sets.
These sets are what is commonly referred to as the solution curves of the ODE \ref{eq:first-order-ode}.
So the structure of an ODE can be thought of points in the plane subdivided into distinct solution curves.

A symmetry of a first order ODE \ref{eq:first-order-ode} is then a transformation that preserves this subdivision of the plane into solution curves.
This property can be defined as:
\begin{defn}[Point symmetry] \label{defn:first-order-symmetry}
  A transformation \(\Gamma: \pqty{x,y} \mapsto \pqty{\hat{x}(x,y), \hat{y}(x,y)}\) is a point symmetry of the ODE \ref{eq:first-order-ode} if and only if
  \begin{equation}
    \dv{y}{x} = \omega(x,y)
    \implies
    \dv{\hat{y}}{\hat{x}} = \omega(\hat{x},\hat{y}).
  \end{equation}
\end{defn}
The \enquote{point} in point symmetry refers to the fact that the transformation \(\Gamma\) only acts on the points belonging to the solution curves and nothing else.
This must not always be the case for symmetries, but that discussion is deferred to a later section of this chapter. % TODO: Make sure that this is true when more is written

%-----------------------------------------------------------------------------
\subsection{Jet spaces}

The observant reader might have already noted that there is some need of clarification of \cref{defn:first-order-symmetry}.
While the transformation \(\Gamma\) treats \(y\) as a point in \(\reals\), the ODE \ref{eq:first-order-ode} treats \(y\) as a differentiable function of \(x\), or in other words an element of once continuously differentiable functions \(\mathcal{C}^1(\reals)\).
In many contexts this abuse of notation could be accepted without further remarks, but in group analysis the subtleties of these representations are key to some important results.
The 

The \(xy\)-plane previously mentioned can be seen as consisting of two components: the independent space \(X \simeq \reals\) and the dependent space \(Y \simeq \reals\).
The plane then is the product space \(E = X \cross Y \simeq \reals^2\).
To be able to formulate differential statements the space \(Y_1 = \reals\), sometimes called the first continuation of \(Y\) with respect to \(X\), is introduced.
The elements of \(Y_1\) will be denoted \(y'\) or \(y^{(1)}\), the notation implying that they correspond to first derivatives of the function \(y(x)\).
A first order ODE can then be written as an equation in the space \(J_1 = J_1 E = E \cross Y_1 \simeq \reals^3\), also known as the first order jet space of \(E\).
The ODE \ref{eq:first-order-ode} is equivalent to
\begin{equation} \label{eq:first-order-jet-ode}
  \varepsilon(\underset{1}{z}) = y' - \omega(x,y) = 0,
\end{equation}
where \(\underset{1}{z} = (x,y,y') \in J_1\).
When dealing with an ODE of higher order, higher order jet spaces \(J_k = J_k E\) are introduced.
These follow the formula
\begin{equation}
  J_k = X \cross Y \cross Y_1 \cross \dots \cross Y_k,
\end{equation}
with elements
\begin{equation}
  \underset{k}{z} = (x, y, y', \dots, y^{(k)}).
\end{equation}
An ODE of degree \(k\) can thus be written on the equivalent form
\begin{equation}
  \varepsilon(\underset{k}{z}) = 0.
\end{equation}

%-----------------------------------------------------------------------------
\subsection{The total derivative}

Since the jet space \(J_k\) treats the variables \((y, y', \dots, y^{(k)})\) as independent coordinates, differentiation in \(x\) will not affect those terms.
While this is then desired behavior of a jet space, there is also a need to be able to mirror the behavior of differentiation of the functions \((y(x), y'(x), \dots, y^{(k)}(x))\) in \(x\).
Thus a differential operator on \(J_k\) is introduced, called the total derivative
\begin{equation}
  D_x = \partial_x + y' \cdot \partial_y + y'' \cdot \partial_{y'} + \dots + y^{(l)} \cdot \partial_{y^{(l-1)}} + \dots .
\end{equation}
\(D_x\) will act on expressions in \(J_k\) in the same way that \(\dv{x}\) would act on equivalent expressions consisting of \(x\), \(y(x)\) and derivatives of \(y(x)\) in \(x\).

A coordinate change \(\hat{x} = \hat{x}(x, y(x)),\, \hat{y} = \hat{y}(x, y(x)) = \hat{y}(\hat{x})\) in the function space can be represented in the jet space using the total derivative.
Due to the chain rule,
\begin{equation}
  \dv{\hat{y}}{\hat{x}} = 
  \frac{\pdv{\hat{y}}{x} + \pdv{\hat{y}}{y} \dv{y}{x}}{\pdv{\hat{x}}{x} + \pdv{\hat{x}}{y} \dv{y}{x}} =
  \frac{\tD{x} \hat{y}(x,y)}{\tD{x} \hat{x}(x,y)}.
\end{equation}
Using this and the equivalent formulation of the ODE \ref{eq:first-order-ode} in \cref{eq:first-order-jet-ode}, \cref{defn:first-order-symmetry} of a first order symmetry can be restated in the first order jet space \(J_1\).
\begin{lem} \label{lem:simple-first-order-symmetry}
  A transformation \(\Gamma: \pqty{x,y} \mapsto \pqty{\hat{x}(x,y), \hat{y}(x,y)}\) is a point symmetry of the ODE \ref{eq:first-order-ode} if
  \begin{equation} \label{eq:simple-first-order-symmetry}
    \frac{\partial_x \hat{y} + \omega(x,y) \partial_y \hat{y}}{\partial_x \hat{x} + \omega(x,y) \partial_y \hat{x}} = \omega(\hat{x},\hat{y})
  \end{equation}
  holds.
\end{lem} % FIXME: Requirement of diffeomorphism
Given a transformation \(\Gamma\), it is therefore easy to check whether it is a point symmetry of the ODE \ref{eq:first-order-ode}.
The reverse process (finding point symmetries of \cref{eq:first-order-ode}) is on the other hand not easy, as \cref{eq:simple-first-order-symmetry} will in all but the most trivial cases result in a non-linear PDE in with two unknown functions.
By restricting attention to a specific type of point symmetries, these conditions can be simplified.

%=============================================================================
\section{Lie point symmetries}

A Lie group is a continuous group, where the continuity between members of the group can be described by one or more real valued parameters.
% TODO: Add more material on Lie groups, maybe as reference or in appendix.
For point symmetries, this means that a group of Lie point symmetries is a collection of transformations that move points in \(E\) smoothly.
The Lie groups are characterized by the dimensionality of these smooth transformations.
When the transformations move a given point \(\fixed{z} \in E\) to new points that together constitute a line, the Lie group is said to be a one parameter Lie group as the transformations can be indexed by a single continuous parameter \(\epsilon \in \reals\).
The transformations in a group of one-parameter Lie point symmetries can thus be parametrized as
\begin{equation} \label{eq:1p-lie-point-symmetry}
  \Gamma_\epsilon: \pqty{x,y} \mapsto \pqty{\hat{x}_\epsilon(x,y), \hat{y}_\epsilon(x,y)},
\end{equation}
where both \(\hat{x}_\epsilon(x,y)\) and \(\hat{y}_\epsilon(x,y)\) are smooth (and therefore differentiable) in \(\epsilon\) when fixing \(x\) and \(y\).
This is most easily showed by a simple example.
\begin{exmp}
  The ODE
  \begin{equation} \label{eq:ex-a:ode}
    \dv{y}{x} = y = \omega(x, y)
  \end{equation}
  has several symmetries.
  One group of symmetries is
  \begin{equation} \label{eq:ex-a:transformation}
    \Gamma_\epsilon(x,y) =
    \pqty{\hat{x}_\epsilon(x,y), \hat{y}_\epsilon(x,y)} =
    \pqty{x + \epsilon, y}, \quad
    \forall \epsilon \in \reals
  \end{equation}
  This can be shown by viewing \cref{eq:ex-a:ode} in the jet space \(J_1\), resulting in
  \begin{equation}
    \frac{\tD{x} \hat{y}_\epsilon(x,y)}{\tD{x} \hat{x}_\epsilon(x,y)} =
    \frac{\partial_x \hat{y}_\epsilon + \omega(x,y) \partial_y \hat{y}_\epsilon}{\partial_x \hat{x}_\epsilon + \omega(x,y) \partial_y \hat{x}_\epsilon} =
    \frac{y}{1} =
    \hat{y}_\epsilon =
    \omega(\hat{x}_\epsilon,\hat{y}_\epsilon), \quad
    \forall \epsilon.
  \end{equation}
  So by \cref{lem:simple-first-order-symmetry} the transformations are point symmetries.
  By fixing \(\pqty{x,y}=\pqty{\fixed{x},\fixed{y}}\),
  \begin{equation}
    \dv{\epsilon} \pqty{\hat{x}_\epsilon(\fixed{x},\fixed{y}), \hat{y}_\epsilon(\fixed{x},\fixed{y})} =
    \pqty{\dv{\fixed{\hat{x}}}{\epsilon}, \dv{\fixed{\hat{y}}}{\epsilon}} =
    \pqty{1,0}
  \end{equation}
  for any \(\pqty{\fixed{x},\fixed{y}}\).
  This means that the transformations are smooth in \(\epsilon\), and thus constitute a one parameter Lie group.
\end{exmp}
While the Lie groups of point symmetries can be parametrized in the explicit way used in \cref{eq:1p-lie-point-symmetry}, it is more useful to characterize the Lie group by its associated vector field
\begin{equation} \label{eq:tangent-field}
  \pqty{\xi(x,y), \eta(x,y)},
\end{equation}
also known as the tangent field of the transformation group.
The tangent field can be calculated pointwise by 
\begin{equation}
  \eval{\dv{\epsilon} \pqty{\hat{x}_\epsilon(\fixed{x},\fixed{y}), \hat{y}_\epsilon(\fixed{x},\fixed{y})}}_{\epsilon=0} = \pqty{\xi(\fixed{x},\fixed{y}), \eta(\fixed{x},\fixed{y})}
\end{equation}
for every fixed point \(\pqty{\fixed{x},\fixed{y}} \in E\).
The tangent field can be thought of as the field that points in \(E\) will flow along when increasing the parameter \(\epsilon\) by which the transformation \(\Gamma_\epsilon\) is selected.

%-----------------------------------------------------------------------------
\subsection{The linearized symmetry condition}

By using the tangent field of a one-parameter Lie symmetry group, the symmetry condition \ref{lem:simple-first-order-symmetry} can be further simplified.
\begin{lem} \label{lem:linearized-first-order-symmetry}
  A Lie group of point transformations is a symmetry of the ODE \ref{eq:first-order-ode} if
  \begin{equation}
    \partial_x \eta + (\partial_y \eta - \partial_x \xi) \omega - \partial_y (\xi) \omega^2 =
    \xi \partial_x \omega + \eta \partial_y \omega,
  \end{equation}
  where \(\pqty{\xi(x,y), \eta(x,y)}\) is the tangent field of the Lie group.
\end{lem} % FIXME: Is this a correct formulation of the theorem?
To roughly prove this, simply take the derivative of \cref{eq:simple-first-order-symmetry} in \(\epsilon\) and then set \(\epsilon\) to 0.
For a more formal proof, refer to [thing]. % FIXME: Should have a reference

% TODO: Figure out better structure for this part
To simplify the notation, a differential operator
\begin{equation}
  X = \xi(x,y) \partial_x + \eta(x,y) \partial_y
\end{equation}
called an infinitesimal generator, can be introduced.
As the generator is defined only by \(\xi\) and \(\eta\), it too serves as a characterization of the Lie symmetry group.
The infinitesimal generator can then be prolonged, still entirely determined by \(\xi\) and \(\eta\), to act on the entire jet space.
For first order differential equations the jet space is \(\pqty{x, y, y'}\), and the prolongation takes the form
\begin{equation}
  X^{(1)} = \xi(x,y) \partial_x + \eta(x,y) \partial_y + \eta^{(1)}(x,y) \partial_{y'},
\end{equation}
where
\begin{equation}
  \eta^{(1)}(x,y) =
  \partial_x(\eta)(x,y) + (\partial_y(\eta)(x,y) - \partial_x(\xi)(x,y)) y' - \partial_y(\xi)(x,y) \left(y'\right)^2.
\end{equation}
This prolongation follows naturally from the prolongation of \(\hat{y}'\) (see [appendix]). % FIXME: Write and insert prolongation details
With this notation we rewrite \cref{lem:linearized-first-order-symmetry} as
\begin{thm} \label{thm:linearized-first-order-symmetry}
  A Lie group of point transformations is a symmetry of the ODE \ref{eq:first-order-ode} if
  \begin{equation} \label{eq:linearized-first-order-symmetry}
    X^{(1)}\left(y' - \omega(x,y)\right) \equiv 0,
    % Hydon has "where eq. (3.1) holds", but that feels a bit off...
    % Stephani says \equiv 0 and (mod H = 0)
  \end{equation}
  where \(X^{(1)}\) is the first prolongation of the infinitesimal generator of the Lie group.
\end{thm} % FIXME: Is this a correct formulation of the theorem?


%-----------------------------------------------------------------------------
\subsection{Invariant solutions and trivial symmetries}
% TODO: Write about invariant solutions and trivial symmetries

% TODO: Write about basis for generators
% TODO: Get canonical coordinates in to the text somehow
