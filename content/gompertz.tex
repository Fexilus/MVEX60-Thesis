\chapter{The Gompertz model}

In several fields in- and outside of the life sciences, growth in general plays an important role.
In particular, when measuring different phenomena ranging from cell growth to the growth of cities, the concept of exponential growth often appears.
Exponential growth stems from a species growing in proportion to the size of the species.
Written in mathematical terms
\begin{equation} \label{eq:exponential}
  \dv{W}{t} = c W(t),
\end{equation}
where \(W(t)\) is the size of our species (volume of a tumor, weight of an animal, individuals in a population etc.) at time \(t\) and \(c\) is a constant.
While exponential growth accurately models initially growth for many systems, eventually some external factor will limit the growth.
The external factor might be simple like limited availability of food in the case of an animal population, or complex like limitations of infrastructure in the case of cities. % FIXME: Check validity of statement
Correctly modeling the external limitations is crucial when studying the long term behavior of the system.

The Gompertz model is one such model that has seen success in many areas.
It was first proposed in 1825 as a means of predicting the mortality rate of populations in order to accurately prize life insurances and annuities \cite{gompertz1825nature}.
Gompertz formulated his model as the differential equation
\begin{equation} \label{eq:original-gompertz}
  a L_x \times q^x \cdot \dot{x} = - (L_x)\dot{}
\end{equation}
where \(L_x\) is the number living at age \(x\), or formulated in modern notation
\begin{equation} \label{eq:original-gompertz-modern}
  \dv{L}{x} = -a q^x L(x)
\end{equation}
where \(L(x)\) is the number of people living at age \(x\).
It is worth noting that at small \(x\) and \(c = -a\), \cref{eq:original-gompertz-modern} behaves like \cref{eq:exponential}.
In retrospect this similarity is not surprising as Gompertz modeled decay (of a population), which can be seen as \enquote{negative growth}.
This connection was however at first not made.

Around a hundred years after the model's conception it saw its first use as a growth model, modeling economic growth \cite{prescott1922demand,peabody1924railway}.
It was first mentioned the life sciences in 1926 as a suggestion of an alternative growth model in a review \cite{wright1926reviews}, and a few years later saw its first concrete use modeling the weight of cattle \cite{davidson1928growth}.
In the century since, the Gompertz model has been used to model the size of a wide range of animals (for a good summary, see \cite{tjorve2017gompertz}).
The breadth of animals (and parts of animals) where the Gompertz model can be fitted well to growth data has made this one of the life sciences where the model is most used.
The other branch of the life sciences where the Gompertz model has seen success is in modeling tumor growth.
The model was first used (apart as a tool for making graphs \cite{casey1934alteration}) for this purpose in 1964 \cite{laird1964dynamics}.
It has since become one of the most widely used models for tumor growth \cite{gerlee2013muddle} (for a summary of applications, see the introduction of \cite{benzekry2014classical}).
When studying both organism and tumor growth, the same question have been asked about the Gompertz model, namely what the biological interpretation of the model is.
In this chapter, this question will be tackled using the theory of Lie point symmetries.

%=============================================================================
\section{Finding a standardized ODE description}

Even though Gompertz first stated his model as the ODE \ref{eq:original-gompertz}, the differential form is not the most commonly used.
Instead the Gompertz model is usually formulated as the solution to \cref{eq:original-gompertz-modern}.
In Gompertz original paper, this function takes the form
\begin{equation} \label{eq:original-gompertz-solution}
  L(x) = d g^{q^x}
\end{equation}
where \(g = \exp(-a/\ln(q))\) in \cref{eq:original-gompertz-modern}.
Note that the parameter \(d\) is not included in the differential equation but instead stems from the constant of integration.
By replacing Gompertz' \(L(x)\) (amount of people of age \(x\)) with \(W(t)\) (the size of a species at time \(t\)) the function can be used to model growth without any structural changes to the function.
The function form of the model is not only sufficient as description when the goal is to fit the model to some data; the third parameter \(d\) is necessary since it relates to the initial value needed to solve \cref{eq:original-gompertz-modern}.
\Cref{eq:original-gompertz-solution} is however not a form where Lie point symmetries can be employed.
Additionally, the function is not parametrized consistently across literature, varying depending on field and taste.
To analyze the model with Lie point symmetries it is therefore necessary to determine two things.
Firstly it must be established what is meant by \enquote{The Gompertz Model} when viewing the model as an ODE through a life since lens.
Secondly, a standardized and meaningful parametrization of the model in ODE form must be established in order to gain insight from the later Lie point symmetry treatment.

Since the function form of the model is sufficient and necessary to match data, the ODE form is only found in literature as a means of providing a background to the model.
The ODE formulation thus often lacks proper references, rendering the origin of the formulation hard to trace.
All formulations of the ODE found in literature can however be sorted into one of three families.

The ODE:s in the first family can all be written on the form
\begin{equation} \label{eq:rough-gompertz-classical-ode}
  \dv{W}{t} = r e^{-b t} W(t).
\end{equation}
These ODE:s are reparameterizations of Gompertz' original ODE \ref{eq:original-gompertz-modern}, often emphasizing the expected behaviors of the model in the growth context by choosing parameters that should be positive.
In the parametrization seen in \cref{eq:rough-gompertz-classical-ode}, \(r\) should be positive for the species size \(W(t)\) to grow (as opposed to shrinking or decaying) and \(b\) should be positive for the growth to reduce over time (and thus limiting the growth).

The first family of ODE:s is tightly related to the second family, which can be written on the form
\begin{equation}
  \label{eq:rough-gompertz-system-ode}
  \begin{aligned} 
    \dv{W}{t} &= \gamma(t) W(t)\\
    \dv{\gamma}{t} &= -b \gamma(t).
  \end{aligned}
\end{equation}
This system of ODE:s could also be argued to be the original Gompertz ODE, since the original differential equation \ref{eq:original-gompertz} was motivated by Gompertz in the following way:
\blockquote[{\cite[518]{gompertz1825nature}}]{
  If the average exhaustions of a man's power to avoid death were such that at the end of equal infinitely small intervals of time, he lost equal portions of his remaining power to oppose destruction which he had at the commencement of thoseintervals, then at the age his power to avoid death, or the intensity of his mortality might be denoted by \(aq^x\), \(a\) and \(q\) being constant quantities;
}
The intensity of mortality can be seen as \(\gamma(t)\) in \cref{eq:rough-gompertz-system-ode}, with \(\gamma(t) = aq^x\) serving as a solution to the lower equation in \ref{eq:rough-gompertz-system-ode} when \(\ln(q) = -b\).
Since \cref{eq:rough-gompertz-classical-ode} is a partial solution to \cref{eq:rough-gompertz-system-ode}, these two families of differential equations will henceforth be referred to collectively as \enquote{classical Gompertz ODE:s}, the latter formulation being specified as \enquote{classical Gompertz ODE:s on system form}.
The classical Gompertz ODE is the form used in the first paper on biological growth \cite{davidson1928growth}.

The third family of ODE:s appear slightly later in the literature.
They can all be written on the form
\begin{equation} \label{eq:rough-gompertz-autonomous-ode}
  \dv{W}{t} = -\alpha \ln(\frac{W(t)}{K}) W(t).
\end{equation}
While solutions to this ODE are all Gompertz curves, it is important to note that this formulation is fundamentally different than the classical ODE in \cref{eq:rough-gompertz-classical-ode}.
This is clear from the fact that while \cref{eq:rough-gompertz-classical-ode} is directly dependent on time, \cref{eq:rough-gompertz-autonomous-ode} is not.
We will therefore henceforth refer to the family of ODE:s that can be rewritten as \cref{eq:rough-gompertz-autonomous-ode} as \enquote{autonomous Gompertz ODE:s}.
The first time an autonomous Gompertz ODE appears in the literature on biological growth is in a review of the new use of the Gompertz curve in 1932 \cite{winsor1932gompertz}.
In the review (which also features a classical Gompertz ODE) the autonomous form is used to liken the Gompertz curve to another popular growth curve, the logistic growth curve, in order to generalize the Gompertz model.

In order to better understand what separates the classical and autonomous ODE:s, a consistent parametrization is required.
Due to the sporadic use of the ODE form, no such standardization has been made.
The function form, on the other hand, has seen efforts of standardized parametrization.
\cite{tjorve2017gompertz} (concerned mainly with the growth of organisms) shows that most parametrizations found in literature belong to two parametrization groups.
Both parametrizations groups have in common that they have two shape parameters and one location parameter, in other words that the third parameter only controls how far the curve is shifted in the time direction.
In both groups the shape parameters serve the same purpose, but the location parameter can serve two distinct useful purposes, resulting in the two forms of parametrization: the \(T_i\)- and \(W_0\)-forms \cite{tjorve2017gompertz}.
These two forms can be canonically parametrized by
\begin{equation} \label{eq:gompertz-ti-function}
  W(t) = A e^{-e^{-k_G(t-T_i)}}
\end{equation}
and
\begin{equation} \label{eq:gompertz-w0-function}
  W(t) = A \left(\frac{W_0}{A}\right)^{-e^{-k_G t}}
\end{equation}
respectively.
These two parametrizations are useful, since the parameters \(A\), \(k_G\), \(T_i\) and \(W_0\) have clear interpretations.
\(A\) is the value of the upper asymptote, also known as the carrying capacity of the system.
\(k_G\), although lacking in interpretation itself, is proportional to \(k_U = k_G / e\), where \(k_U\) is the relative (to \(A\)) maximum slope during the process.
Together, \(A\) and \(k_G\) control the shape of the curve.
\(T_i\) or \(W_0\) depending on the formulation control the localization of the curve.
\(T_i\) is the point in time where the curve achieves its maximum slope, also known as the point of inflection.
% TODO: Write about when this formulation is useful
\(W_0\) on the other hand is the size at \(t=0\).
Depending on application either of these two parametrizations might be useful.
It is therefore necessary to reparametrize both ODE:s \ref{eq:rough-gompertz-classical-ode} and \ref{eq:rough-gompertz-autonomous-ode} using both forms.

To reparametrize the ODE:s using Gompertz curve parametrizations, the solutions of the ODE:s must be found.
The classical Gompertz ODE \ref{eq:rough-gompertz-classical-ode} is most easily solved using the fact is separable to integrate over \(W\) and \(t\) separately.
The solutions are thus
\begin{equation} \label{eq:gompertz-classical-solution}
  W(t) = c e^{-r/b \cdot e^{-b t}}
\end{equation}
where \(c\) is an arbitrary constant.
The autonomous Gompertz ODE \ref{eq:rough-gompertz-autonomous-ode} is most easily solved using the variable substitution \(y(t) = \ln(W(t)/K)\) and then solving the resulting ODE.
The solutions are thus on the form
\begin{equation} \label{eq:gompertz-autonomous-solution}
  W(t) = K e^{c e^{-\alpha t}}
\end{equation}
where \(c\) is an integration constant.
Comparing the solutions in \cref{eq:gompertz-classical-solution,eq:gompertz-autonomous-solution} to the \(T_i\)- and \(W_0\)-formulations in \cref{eq:gompertz-ti-function,eq:gompertz-w0-function}, the relationships
\begin{align}
  b &= k_G\\
  r &= k_G e^{k_G T_i}\\
  r &= k_G \ln(\frac{W_0}{A})\\
  \alpha &= k_G\\
  K &= A
\end{align}
between the parameters can be found.
The classical Gompertz ODE \ref{eq:rough-gompertz-classical-ode} and the autonomous Gompertz ODE \ref{eq:rough-gompertz-autonomous-ode} can thus be reparametrized as
\begin{flalign}
    \text{Classical, } & T_i :& \dv{W}{t} &= k_G e^{-k_G (t - T_i)} W(t) &&\FlLabel{eq:gompertz-classical-ti} \\
    \text{Classical, } & W_0 :& \dv{W}{t} &= k_G \ln(\frac{W_0}{A})e^{-k_G t} W(t) &&\FlLabel{eq:gompertz-classical-w0} \\
    \text{Autonomous, } & T_i \text{ and } W_0 :& \dv{W}{t} &= -k_G \ln(\frac{W(t)}{A}) W(t). &&\FlLabel{eq:gompertz-autonomous}
\end{flalign}
There are two important notes worth highlighting:
Firstly, all three formulations have two degrees of freedom, even \cref{{eq:gompertz-classical-w0}} since \(W_0\) and \(A\) only appear in the composite form \(W_0 / A\).
This must be the case since only a two parameter ODE can produce three parameter solutions (which the Gompertz curves are).
Secondly, it should be stressed that \cref{eq:gompertz-classical-ti,eq:gompertz-classical-w0} are just two different parametrizations of the same differential equation.
They will thus share symmetries, and calculations need only be performed on one form.

Before applying symmetry methods to the respective ODE:s, some insights are gained merely from the reparameterization.
For both the classical and autonomous Gompertz ODE:s, the growth rate \(k_G\) is a property of the system characterized by the respective ODE:s.
This means that\dots% TODO: Write about insights

% TODO: Somewhere around here the jet space notation and \omega_c, \omega_a forms should be introduced.

%=============================================================================
\section{Finding Lie point symmetries}

Since the ODE:s are of the first order, an ansatz must be made in order to solve the determining equations.
Beginning with the autonomous ODE, the ansatz
\begin{align}
  \xi(t, W) &= f_1(t) + f_2(t) \ln(\frac{W}{A}),\\
  \eta(t, W) &= f_3(t) W + f_4(t) \ln(\frac{W}{A}) W
\end{align}
can be taken, where \(f_i\) for \(i =1,2,3,4\) are arbitrary functions in \(t\).
This results in the determining equation
\begin{align}
  f_3'(t) W &+ f_4'(t) \ln(\frac{W}{A}) W \\
  &+ \left( f_3(t) + f_4(t) \left( 1 + \ln(\frac{W}{A}) \right) - \left( f_1'(t) + f_2'(t) \ln(\frac{W}{A}) \right) \right) \cdot -k_G \ln(\frac{W}{A}) W \\
  &- \frac{f_2(t)}{W} \left( k_G \ln(\frac{W}{A}) W \right)^2 =\\
  &= \left( f_3(t) W + f_4(t) \ln(\frac{W}{A}) W \right) \cdot -k_G \left( 1 + \ln(\frac{W}{A}) \right)
\end{align}
which can be reduced to
\begin{align}
  f_3'(t) W &+ \left( f_4'(t) + k_G f_1'(t) \right) \ln(\frac{W}{A}) W + \left( f_2'(t) - k_G f_2(t) \right) k_G \ln(\frac{W}{A})^2 W =\\
  &= - k_G f_3(t) W
\end{align}
By separating the equation based on powers of \(\ln(\frac{W}{A})\), the system
\begin{flalign}
  W & : & f_3'(t) &= -k_G f_3(t) && \FlLabel{eq:W}\\
  \ln(\frac{W}{A}) W & : & f_4'(t) + k_G f_1'(t) &= 0 && \FlLabel{eq:WA}\\
  k_G \ln(\frac{W}{A})^2 W & : & f_2'(t) - k_G f_2(t) &= 0 && \FlLabel{eq:kW2A2W}
\end{flalign}
can be acquired.
This system of equations has the solution
\begin{align}
  \xi(t, W) &= f_1(t) + c_1 e^{k_G t} \ln(\frac{W}{A}),\\
  \eta(t, W) &= c_2 e^{-k_G t} W + \left( c_3 - k_G f_1(t) \right) \ln(\frac{W}{A}) W,
\end{align}
where \(c_1\), \(c_2\) and \(c_3\) are arbitrary constants.
Thus, by separating the tangent field into terms with independent arbitrary elements, the infinitesimal generators
\begin{align}
  X_1 &= e^{k_G t} \ln(\frac{W}{A}) \partial_t \\
  X_2 &= e^{-k_G t} W \partial_W \\
  X_3 &= \ln(\frac{W}{A}) W \partial_W \\
  X_f &= f(t) \partial_t - k_G f(t) \ln(\frac{W}{A}) W \partial_W
\end{align}
of Lie point symmetries of the autonomous Gompertz ODE \ref{eq:gompertz-autonomous} can be found.

The symmetry generator \(X_f\) is a trivial symmetry of the autonomous ODE, since the reduced characteristic of it is
\begin{align}
  \bar{Q}_{f,a}(t, W) &= \eta_f(t, W) - \omega_a(t, W) \xi_f(t, W)\\
  &= - k_G f(t) \ln(\frac{W}{A}) W - \left(-k_G \ln(\frac{W}{A}) W \right) f(t) \equiv 0.
\end{align}
The reduced characteristic of \(X_F\) for the classical ODE is
\begin{align}
  \bar{Q}_{f,c}(t, W) &= \eta_f(t, W) - \omega_c(t, W) \xi_f(t, W)\\
  &= - k_G f(t) \ln(\frac{W}{A}) W - k_G e^{-k_G (t - T_i)} W f(t)\\
  &= - k_G f(t) W \left(\ln(\frac{W}{A}) + e^{-k_G (t - T_i)}\right).
\end{align}
It is worth noting that since \(A\) is not a parameter of the classical ODE \ref{eq:gompertz-classical-ti}, only symmetries that hold for any \(A\) will be actual symmetries.
The linearized symmetry condition for the classical ODE can be formulated as
\begin{equation}
  \partial_t(\bar{Q}_{f,c}) + \omega_c \partial_W(\bar{Q}_{f,c}) = \partial_W(\omega_c) \bar{Q}_{f,c}
\end{equation}
Letting \(f(t) \equiv 1\), the left hand side becomes
\begin{gather}
  k_G^2 W e^{-k_G (t - T_i)} + \left(k_G e^{-k_G (t - T_i)} W\right) \left(-k_G \left(\ln(\frac{W}{A}) + e^{-k_G (t - T_i)} + 1\right)\right)\\
  -k_G^2 e^{-k_G (t - T_i)} W\left(\ln(\frac{W}{A}) + e^{-k_G (t - T_i)}\right)
\end{gather}
while the right hand side becomes
\begin{gather}
  \left(k_G e^{-k_G (t - T_i)}\right) \left(- k_G W \left(\ln(\frac{W}{A}) + e^{-k_G (t - T_i)}\right)\right)\\
  -k_G^2 e^{-k_G (t - T_i)} W \left(\ln(\frac{W}{A}) + e^{-k_G (t - T_i)}\right).
\end{gather}
The two sides are equivalent, and thus \(X_{f\equiv1}\) is a symmetry of the classical Gompertz ODE.
Since \(X_{f\equiv1}\) is trivial on the autonomous ODE, the lines along the tangent field are solutions to the autonomous ODE.
This means that the solutions to the autonomous ODE are orbits of the classical ODE.
It is worth noting that for all of the above calculations to hold, the growth parameter \(k_G\) must be the same for both ODE:s.

%=============================================================================
\section{Future leads}

Some future leads when studying the Gompertz model using symmetry methods are:
\begin{itemize}
  \item Try proving allometry properties when considering embryogenesis of the Gompertz model \cite{deakin1970allometry}.
  \item Reevaluate motivations of the Gompertz model \cite{bajzer1997tumor}.
  \item See if a more advanced empirical model that also hold in small time shares any symmetries \cite{frenzen1986justification}.
  \item See if a necrosis model shares any symmetries \cite{milotti2012interplay}.
\end{itemize}

%=============================================================================
\section{Half way summary}

At the current point in time, a few conclusions can be drawn.
Firstly, without analyzing the symmetries, some of the differences of the two ODE formulations of the Gompertz model are apparent.
The classical ODE concerns itself with growth systems with specific timings, while the autonomous ODE concerns itself with growth systems with specific carrying capacities.
In and of it self this is of course valuable information.
But secondly, the symmetry calculations show that the autonomous ODE has distinct symmetries.
If conclusions can be drawn about the connection of one of those symmetries to a qualitative property of a growth system, this could be used as a tool to invalidate the hypothesis that the classical ODE correctly models a phenomena.
Conversely, if distinct symmetries of the classical ODE can be found and connected to qualitative properties, those could be used to invalidate the use of the autonomous ODE for some problems.
