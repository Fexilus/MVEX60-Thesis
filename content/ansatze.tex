\chapter{Finding symmetries using ansätze}

In this chapter symmetries of the models are found using ansätze.
At some point there will be a nice introduction here.

\section{The Hill equation}

In this section, Lie point symmetries for the Hill equation will be calculated.
Since this work has already been done in \cite{ohlsson2020symmetry}, this will serve as a reproduction of their results.

\subsection{A useful infinitesimal generator}

The Hill equation
\begin{equation} \label{eq:hill^ansatze}
  \diff{y}{\tau} = - \frac{y^n}{1 + y^n} = \omega_n(\tau, y), \quad
  n > 0.
\end{equation}
clearly has at least the Lie symmetry generator \(X=\partial_\tau\).
This can be seen by observing that \cref{eq:hill^ansatze} has no \(\tau\) in either side's expression (remember that the equation is viewed in terms of its lift, residing in the jet space \(J^1\)).
However, one purpose of finding symmetries of differential equations is to distinguish between models.
Since the symmetry \(X=\partial_\tau\) holds for all \(n\), it can not be used to compare different degrees of Hill equations.
Thus, finding an additional Lie symmetry group of the Hill equation is therefore of interest.

Any Lie point symmetry group must fulfill the linearized symmetry condition \labelcref{lem:linearized-first-order-symmetry}.
To solve \cref{eq:linearized-first-order-symmetry}, an Ansatz must be made.
The tangent fields of many Lie symmetries of ODE:s are linear in \(y\).
The Ansatz
\begin{equation}
  \pqty{\xi(\tau,y),\eta(\tau,y)} = \pqty{A(\tau) + B(\tau)y,C(\tau) + D(\tau)y}
\end{equation}
is therefore used.
Inserting the Ansatz into \cref{eq:linearized-first-order-symmetry}, and using the fact that \(y' = y^n / (1 + y^n)\), gives that
\begin{equation}
  (C' + D'y) + (A' + B'y - D) \frac{y^n}{1 + y^n} - B \frac{y^{2n}}{(1 + y^n)^2} =
  -n(C + Dy) \frac{y^{n-1}}{(1 + y^n)^2}.
\end{equation}
Multiplication with \((1 + y^n)^2\) in turn gives that
\begin{equation} \label{eq:hill-linear-symmetry}
  (C' + D'y)(1 + y^n)^2 + (A' + B'y - D)y^n(1 + y^n) - By^{2n} =
  -n(C + Dy) y^{n-1}.
\end{equation}
The equation can then be separated by powers of \(y\) into a system of equations.
However, since \(n\) is specified to be positive, care must be taken to ensure that the separation holds for all \(n>0\).

\subsubsection{Case of \texorpdfstring{\(n\neq1,2\)}{n not 1 or 2}}

When \(n>0\) and \(n\neq1,2\), all of the possible powers of \(y\) will be different.
\Cref{eq:hill-linear-symmetry} can the be separated into the system
\begin{subequations}
  \begin{flalign}
    y^0:      && C'(\tau) &= 0                               &&\FlLabel{eq:det-any-0}\\
    y^1:      && D'(\tau) &= 0                               &&\FlLabel{eq:det-any-1} \\
    y^{n-1}:  && 0 &= -nC(\tau)                              &&\FlLabel{eq:det-any-nm1} \\
    y^n:      && 2C'(\tau) + A'(\tau) - D(\tau) &= -nD(\tau) &&\FlLabel{eq:det-any-n} \\
    y^{n+1}:  && 2D'(\tau) + B'(\tau) &= 0                   &&\FlLabel{eq:det-any-np1} \\
    y^{2n}:   && C'(\tau) A'(\tau) - D(\tau) - B(\tau) &= 0  &&\FlLabel{eq:det-any-2n} \\
    y^{2n+1}: && D'(\tau) + B'(\tau) &= 0.                   &&\FlLabel{eq:det-any-2np1}
  \end{flalign}
\end{subequations}
From \cref{eq:det-any-nm1}
\begin{equation}
  C(\tau) = 0,
\end{equation}
which renders \cref{eq:det-any-0} irrelevant.
\Cref{eq:det-any-1} gives
\begin{equation}
  D(\tau) = c_1
\end{equation}
for a constant \(c_1\) (constants will further be denoted \(c_i\)).
\Cref{eq:det-any-n} can with the determined values for \(C\) and \(D\) be reduced to
\begin{equation}
  A'(\tau) = (1-n) c_1,
\end{equation}
which means that
\begin{equation}
  A(\tau) = c_2 + (1-n) c_1 x.
\end{equation}
Using \cref{eq:det-any-np1} and the determined value of \(D\),
\begin{equation}
  B(\tau) = c_3,
\end{equation}
which in turn renders \cref{eq:det-any-2np1} irrelevant.
Lastly, \cref{eq:det-any-2n} can be reduced to
\begin{equation}
  (1-n) c_1 - c_1 - c_3 = 0,
\end{equation}
which means that
\begin{equation}
  c_3 = -n c_1.
\end{equation}
All tangent fields given the Ansatz must therefore be on the form
\begin{equation} \label{eq:hill-tangent-field-any}
  \pqty{\xi_n(\tau,y),\eta_n(\tau,y)} = 
  \pqty{\tilde{c}_1 + \tilde{c}_2 \left( (1-n) \tau - n y \right), \tilde{c}_2 y}.
\end{equation}

\subsubsection{Case of \texorpdfstring{\(n=1\)}{n is 1}}

When \(n=1\) several pairs of powers of \(y\) become equal.
\(y^0 = y^{n-1}\), \(y^1 = y^n\) and \(y^{n+1} = y^{2n}\).
\Cref{eq:hill-linear-symmetry} is therefore separated into the system
\begin{subequations}
  \begin{flalign}
    y^0:  && C'(\tau) &= -C(\tau) &&\FlLabel{eq:det-1-0}\\
    y^1:  && D'(\tau) + 2C'(\tau) + A'(\tau) - D(\tau) &= -D(\tau) &&\FlLabel{eq:det-1-1}\\
    y^2:  && 2D'(\tau) + B'(\tau) + C'(\tau) + A'(\tau) - D(\tau) - B(\tau) &= 0 &&\FlLabel{eq:det-1-2}\\
    y^3:  && D'(\tau) + B'(\tau) &= 0. &&\FlLabel{eq:det-1-3}
  \end{flalign}
\end{subequations}
Using \cref{eq:det-1-3}, the relation
\begin{equation} \label{eq:det-1-DB-rel}
  D(\tau) = - B(\tau) + c_1
\end{equation}
can be established.
\Cref{eq:det-1-0} leads to
\begin{equation} \label{eq:det-1-first-C}
  C(\tau) = c_2 e^{-\tau}.
\end{equation}
Subtracting \cref{eq:det-1-1} from \cref{eq:det-1-2} leads to the equation
\begin{equation}
  D'(\tau) + B'(\tau) - C'(\tau) - B(\tau) = D(\tau),
\end{equation}
which by using \cref{eq:det-1-DB-rel,eq:det-1-first-C} can be simplified to
\begin{equation}
  c_2 e^{-\tau} = c_1.
\end{equation}
This only holds if \(c_1 = c_2 = 0\) so
\begin{gather}
  C(\tau) = 0 \\
  D(\tau) = - B(\tau).
\end{gather}
Finally, \cref{eq:det-1-1} simplifies to
\begin{equation}
  D'(\tau) + A'(\tau) = 0,
\end{equation}
which integrates to
\begin{equation}
  D(\tau) = - A(\tau) + c_3.
\end{equation}
Thus, all tangent fields given the Ansatz must be on the form
\begin{equation} \label{eq:hill-tangent-field-1}
  \pqty{\xi_1(\tau,y),\eta_1(\tau,y)} = 
  \pqty{A(\tau) + \left( A(\tau) + \tilde{c}_1 \right) y, - \left( A(\tau) + \tilde{c}_1 \right) y}.
\end{equation}

\subsubsection{Case of \texorpdfstring{\(n=2\)}{n is 2}}

When \(n=2\), \(y^1 = y^{n-1}\).
\Cref{eq:hill-linear-symmetry} then separates into the system
\begin{subequations}
  \begin{flalign}
      y^0:  && C'(\tau) &= 0                               &&\FlLabel{eq:det-2-0}\\
      y^1:  && D'(\tau) &= -2C(\tau)                       &&\FlLabel{eq:det-2-1}\\
      y^2:  && 2C'(\tau) + A'(\tau) - D(\tau) &= -2D(\tau) &&\FlLabel{eq:det-2-2}\\
      y^3:  && 2D'(\tau) + B'(\tau) &= 0                   &&\FlLabel{eq:det-2-3}\\
      y^4:  && C'(\tau) A'(\tau) - D(\tau) - B(\tau) &= 0  &&\FlLabel{eq:det-2-4}\\
      y^5:  && D'(\tau) + B'(\tau) &= 0.                   &&\FlLabel{eq:det-2-5}
  \end{flalign}
\end{subequations}
Subtracting \cref{eq:det-2-5} from \cref{eq:det-2-3} gives
\begin{equation}
  D'(\tau) = 0,
\end{equation}
which integrates to
\begin{equation}
  D(\tau) = c_1.
\end{equation}
Thus \cref{eq:det-2-1} gives
\begin{equation}
  C(\tau) = 0,
\end{equation}
which renders \cref{eq:det-2-0} irrelevant.
\Cref{eq:det-2-2} simplifies to
\begin{equation}
  A'(\tau) = - c_1,
\end{equation}
which integrates to
\begin{equation}
  A(\tau) = c_2 - c_1 \tau.
\end{equation}
\Cref{eq:det-2-4} simplifies to
\begin{equation}
  - c_1 - c_1 - B(\tau) = 0,
\end{equation}
which means that
\begin{equation}
  B(\tau) = -2 c_1
\end{equation}
and renders \cref{eq:det-2-5} irrelevant.
Thus, all tangent fields must given the Ansatz be on the form
\begin{equation} \label{eq:hill-tangent-field-2}
  \pqty{\xi_2(\tau,y),\eta_2(\tau,y)} = 
  \pqty{\tilde{c}_1 + \tilde{c}_2 \left( - \tau -2 y \right), \tilde{c}_2 y}.
\end{equation}

\subsection{General form}

To unify notation for any \(n>0\), \cref{eq:hill-tangent-field-any,eq:hill-tangent-field-1,eq:hill-tangent-field-2} can be summarized as
\begin{equation} \label{eq:hill-tangent-field}
  \pqty{\xi_n(\tau,y),\eta_n(\tau,y)} = 
  \pqty{\tilde{c}_1 + \tilde{c}_2 \left( (1-n) \tau - n y \right), \tilde{c}_2 y}.
\end{equation}
For \(n=1\) this form can be achieved by specifying that \(A(\tau)\) has a constant value and grouping the two resulting constants in the right way.
As this constriction on \(A(\tau)\) when \(n=1\) is only made to get a common expression, while for all other \(n>0\) the expression in \cref{eq:hill-tangent-field} constitutes all symmetries whose generators are linear in \(y\), certain underlying structures of the ODE are only present when \(n=1\). % FIXME: Bad formulation

The aim of this section was to find a useful symmetry group.
That is, a symmetry group that varies for different Hill coefficients \(n\).
The symmetry group in \cref{eq:hill-tangent-field} clearly varies in such a way.
Just from looking at the problem, it was also determined that there is a symmetry group generated by \(\pqty{\xi,\eta} = \pqty{1,0}\) that does not vary with \(n\).
As this generator is linear in \(y\), it is part of the generator in \cref{eq:hill-tangent-field}.
By separating the generator by the terms with \(\tilde{c}_1\) and \(\tilde{c}_2\), a basis for the vector space of symmetry groups on the form in \cref{eq:hill-tangent-field} can be established.
One natural basis is
\begin{gather}
  X_1 = \partial_\tau \\
  X_2 = - \left( (n-1) \tau + n y \right) \partial_\tau + y \partial_y,
\end{gather}
where \(X_1\) generates the non-varying symmetry group observed.
\(X_2\) on the other hand generates symmetry groups varying with \(n\), and can thus be used to distinguish between different Hill equations.

\section{The Gompertz model}

\subsection{The autonomous Gompertz ODE}

\begin{align}
  \xi(t, W) &= f_1(t) + f_2(t) \ln(\frac{W}{A}),\\
  \eta(t, W) &= f_3(t) W + f_4(t) \ln(\frac{W}{A}) W
\end{align}
can be taken, where \(f_i\) for \(i =1,2,3,4\) are arbitrary functions in \(t\).
This results in the determining equation
\begin{align}
  f_3'(t) W &+ f_4'(t) \ln(\frac{W}{A}) W \\
  &+ \left( f_3(t) + f_4(t) \left( 1 + \ln(\frac{W}{A}) \right) - \left( f_1'(t) + f_2'(t) \ln(\frac{W}{A}) \right) \right) \cdot -k_G \ln(\frac{W}{A}) W \\
  &- \frac{f_2(t)}{W} \left( k_G \ln(\frac{W}{A}) W \right)^2 =\\
  &= \left( f_3(t) W + f_4(t) \ln(\frac{W}{A}) W \right) \cdot -k_G \left( 1 + \ln(\frac{W}{A}) \right)
\end{align}
which can be reduced to
\begin{align}
  f_3'(t) W &+ \left( f_4'(t) + k_G f_1'(t) \right) \ln(\frac{W}{A}) W + \left( f_2'(t) - k_G f_2(t) \right) k_G \ln(\frac{W}{A})^2 W =\\
  &= - k_G f_3(t) W
\end{align}
By separating the equation based on powers of \(\ln(\frac{W}{A})\), the system
\begin{flalign}
  W & : & f_3'(t) &= -k_G f_3(t) && \FlLabel{eq:W}\\
  \ln(\frac{W}{A}) W & : & f_4'(t) + k_G f_1'(t) &= 0 && \FlLabel{eq:WA}\\
  k_G \ln(\frac{W}{A})^2 W & : & f_2'(t) - k_G f_2(t) &= 0 && \FlLabel{eq:kW2A2W}
\end{flalign}
can be acquired.
This system of equations has the solution
\begin{align}
  \xi(t, W) &= f_1(t) + c_1 e^{k_G t} \ln(\frac{W}{A}),\\
  \eta(t, W) &= c_2 e^{-k_G t} W + \left( c_3 - k_G f_1(t) \right) \ln(\frac{W}{A}) W,
\end{align}
where \(c_1\), \(c_2\) and \(c_3\) are arbitrary constants.
Thus, by separating the tangent field into terms with independent arbitrary elements, the infinitesimal generators
\begin{align}
  X_1 &= e^{k_G t} \ln(\frac{W}{A}) \partial_t \\
  X_2 &= e^{-k_G t} W \partial_W \\
  X_3 &= \ln(\frac{W}{A}) W \partial_W \\
  X_f &= f(t) \partial_t - k_G f(t) \ln(\frac{W}{A}) W \partial_W
\end{align}
of Lie point symmetries of the autonomous Gompertz ODE \labelcref{eq:gompertz-autonomous} can be found.

The symmetry generator \(X_f\) is a trivial symmetry of the autonomous ODE, since the reduced characteristic of it is
\begin{align}
  \bar{Q}_{f,a}(t, W) &= \eta_f(t, W) - \omega_a(t, W) \xi_f(t, W)\\
  &= - k_G f(t) \ln(\frac{W}{A}) W - \left(-k_G \ln(\frac{W}{A}) W \right) f(t) \equiv 0.
\end{align}
The reduced characteristic of \(X_F\) for the classical ODE is
\begin{align}
  \bar{Q}_{f,c}(t, W) &= \eta_f(t, W) - \omega_c(t, W) \xi_f(t, W)\\
  &= - k_G f(t) \ln(\frac{W}{A}) W - k_G e^{-k_G (t - T_i)} W f(t)\\
  &= - k_G f(t) W \left(\ln(\frac{W}{A}) + e^{-k_G (t - T_i)}\right).
\end{align}
It is worth noting that since \(A\) is not a parameter of the classical ODE \labelcref{eq:gompertz-classical-ti}, only symmetries that hold for any \(A\) will be actual symmetries.
The linearized symmetry condition for the classical ODE can be formulated as
\begin{equation}
  \partial_t(\bar{Q}_{f,c}) + \omega_c \partial_W(\bar{Q}_{f,c}) = \partial_W(\omega_c) \bar{Q}_{f,c}
\end{equation}
Letting \(f(t) \equiv 1\), the left hand side becomes
\begin{gather}
  k_G^2 W e^{-k_G (t - T_i)} + \left(k_G e^{-k_G (t - T_i)} W\right) \left(-k_G \left(\ln(\frac{W}{A}) + e^{-k_G (t - T_i)} + 1\right)\right)\\
  -k_G^2 e^{-k_G (t - T_i)} W\left(\ln(\frac{W}{A}) + e^{-k_G (t - T_i)}\right)
\end{gather}
while the right hand side becomes
\begin{gather}
  \left(k_G e^{-k_G (t - T_i)}\right) \left(- k_G W \left(\ln(\frac{W}{A}) + e^{-k_G (t - T_i)}\right)\right)\\
  -k_G^2 e^{-k_G (t - T_i)} W \left(\ln(\frac{W}{A}) + e^{-k_G (t - T_i)}\right).
\end{gather}
The two sides are equivalent, and thus \(X_{f\equiv1}\) is a symmetry of the classical Gompertz ODE.
Since \(X_{f\equiv1}\) is trivial on the autonomous ODE, the lines along the tangent field are solutions to the autonomous ODE.
This means that the solutions to the autonomous ODE are orbits of the classical ODE.
It is worth noting that for all of the above calculations to hold, the growth parameter \(k_G\) must be the same for both ODE:s.
